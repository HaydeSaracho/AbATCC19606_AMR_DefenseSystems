# AbATCC19606_AMR_DefenseSystems

This repository contains a reproducible workflow to download *Acinetobacter baumannii* ATCC 19606 genomes from NCBI, annotate antimicrobial resistance genes using ABRicate (with the CARD database), and predict anti-phage defense systems with PADLOC and DefenseFinder.

## Download Genomes of *Acinetobacter baumannii* ATCC 19606

This section describes how to download genomic sequences of *Acinetobacter baumannii* ATCC 19606 from NCBI GenBank. The workflow uses Linux command-line tools and is reproducible.

```bash
# 1. Create a directory for the genome sequences
mkdir AbATCC19606_Sequences
cd AbATCC19606_Sequences

# 2. Download the GenBank assembly summary file
wget https://ftp.ncbi.nlm.nih.gov/genomes/genbank/assembly_summary_genbank.txt

# 3. Filter the table for Acinetobacter baumannii ATCC 19606 assemblies
cat assembly_summary_genbank.txt | grep "Acinetobacter" | grep "baumannii" | grep "ATCC" | grep "19606" > AbATCC19606_assembly_summary_genbank.tsv

# 4. (Optional) Clean and transform the file manually if needed

# 5. Generate the URLs of genomic FASTA files
awk -F'\t' 'NR>1 && $9!="" {split($9,a,"/"); base=a[length(a)]; print $9 "/" base "_genomic.fna.gz"}' AbATCC19606_assembly_summary_genbank.tsv > AbATCC19606_genomes_urls.txt

# 6. Download the genome FASTA files
wget -i AbATCC19606_genomes_urls.txt

# 7. Decompress the downloaded FASTA files
gzip -d *.fna.gz
```

## Detect antimicrobial resistance genes

This step identifies antimicrobial resistance (AMR) genes in the genomes using **ABRicate** with the **CARD** database.

```bash
# Create directory for results
mkdir -p Antimicrobial_resistance_genes

# Run ABRicate on all genome sequences
for f in ./AbATCC19606_Sequences/*.fna; do
    base=$(basename "$f" .fna)
    for db in card; do
        abricate --db $db "$f" > "Antimicrobial_resistance_genes/${base}_${db}.tab"
    done
done

# Merge .tab files
cat *.tab > Results_AbATCC19606_CARD.tab
```

### Process AMR results in Power Query

The raw output obtained from ABRicate was processed using **Power Query** in Excel to prepare a clean table for downstream analysis.

#### Steps performed
1. Imported the `.tab` file generated by ABRicate into Power Query.
2. Split columns by delimiter
3. Removed unnecessary columns (for this study).
4. Applied text cleaning (capitalization, standardization of names).

The final table contains three key columns:  
- **ASSEMBLY_ID** → identifier of each genome assembly.  
- **GENE** → antimicrobial resistance gene detected.  
- **RESISTANCE** → associated antimicrobial category.  

Below is an example of the processed table in Power Query:

![Processing the Card Table in Power Query](images/CARD_Table_Power_Query.jpeg)

## Detect phage defense systems

### Using PADLOC

```bash
# Create directory for results
mkdir -p PADLOC_results

# Run PADLOC on all assemblies
for f in ./AbATCC19606_Sequences/*.fna; do
    base=$(basename "$f" .fna)
    padloc --fna "$f" --outdir PADLOC_results/${base}_padloc_results
done

# Merge .tab files
cat *.csv > Results_AbATCC19606_PADLOC.csv
```

### Process PADLOC results in Power Query

The raw output obtained from PADLOC was processed using **Power Query** in Excel to prepare a clean table for downstream analysis.

#### Steps performed
1. Imported the .csv file generated by PADLOC into Power Query.
2. Changed data types for consistency.
3. Removed unnecessary columns (for this analysis).
4. Renamed columns for clarity.
5. Reordered columns for readability.

The final table contains three key columns:

**Assembly_ID** → identifier of each genome assembly.
**System** → predicted phage defense system.
**Protein_Name** → protein(s) associated with the system.

Below is an example of the processed table in Power Query:

![Processing the Card Table in Power Query](images/PADLOC_Table_Power_Query.jpeg)
